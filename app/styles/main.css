@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    /* Dark Fantasy Theme Variables */
    --background: 222.2 84% 4.9%;   /* slate-950 */
    --foreground: 210 40% 98%;
    --card: 222.2 84% 6.9%;
    --card-foreground: 210 40% 98%;
    --popover: 222.2 84% 4.9%;
    --popover-foreground: 210 40% 98%;
    --primary: 35.5 91.7% 32.9%; /* Amber/Gold */
    --primary-foreground: 210 40% 98%;
    --secondary: 217.2 32.6% 17.5%;
    --secondary-foreground: 210 40% 98%;
    --muted: 217.2 32.6% 12.5%;
    --muted-foreground: 215 20.2% 65.1%;
    --accent: 217.2 32.6% 17.5%;
    --accent-foreground: 210 40% 98%;
    --destructive: 0 62.8% 30.6%;
    --destructive-foreground: 210 40% 98%;
    --border: 217.2 32.6% 17.5%;
    --input: 217.2 32.6% 17.5%;
    --ring: 35.5 91.7% 32.9%;
    --radius: 0.5rem;
  }

  html { scroll-behavior: smooth; }
  body { @apply bg-background text-foreground font-sans antialiased; font-feature-settings: "rlig" 1, "calt" 1; min-height: 100vh; background-color: hsl(var(--background)); color: hsl(var(--foreground)); font-family: 'Inter', sans-serif; }
  
  ::-webkit-scrollbar { width: 14px; height: 14px; }
  ::-webkit-scrollbar-track { background: hsl(var(--card)); }
  ::-webkit-scrollbar-thumb { background: hsl(var(--secondary)); border-radius: 10px; border: 3px solid hsl(var(--card)); }
  ::-webkit-scrollbar-thumb:hover { background: hsl(var(--primary)); }
  
  /* Rank Highlights */
  #ranking-table-body tr:nth-child(1) td:nth-child(2)::before { content: 'ðŸ¥‡ '; @apply text-amber-400 inline-block mr-1; }
  #ranking-table-body tr:nth-child(2) td:nth-child(2)::before { content: 'ðŸ¥ˆ '; @apply text-slate-400 inline-block mr-1; }
  #ranking-table-body tr:nth-child(3) td:nth-child(2)::before { content: 'ðŸ¥‰ '; @apply text-orange-500 inline-block mr-1; }
  
  /* Spinner */
  .spinner { border: 4px solid rgba(255, 255, 255, 0.3); border-radius: 50%; border-top-color: hsl(var(--primary)); width: 2rem; height: 2rem; animation: spin 1s ease-in-out infinite; margin: 1rem auto; }
  @keyframes spin { to { transform: rotate(360deg); } }
  
  /* Sticky Header - Needs lower z-index than modal */
  #detailed-table-container thead,
  #ranking-section thead,
  #score-rules-table-container thead,
  #category-analysis-content thead {
    position: sticky; /* Required for top positioning */
    top: 0; /* Stick to the top of the container */
    @apply z-10; /* Keep table headers above table content but below modal */
  }
  
  /* Focus Visible */
  *:focus-visible { @apply outline-none ring-2 ring-offset-2 ring-offset-background ring-ring; }
  
  /* Active Nav Link Style (Desktop) */
  header nav a.nav-link.active { @apply text-primary border-primary; }
  
  /* Mobile Active Nav Link Style */
  #mobile-menu .nav-link.active { @apply bg-primary text-primary-foreground; }
  
  /* Language Switcher Style */
  .lang-button.active { @apply bg-primary/20 text-primary; }
  
  /* Chart toolbar styling - Ensure it's above sticky headers but below modal */
  .apexcharts-toolbar { @apply z-20; }
  
  /* Custom tooltips for ApexCharts toolbar buttons */
  .apexcharts-toolbar-custom-tooltip {
    position: absolute;
    background: #0f172a;
    color: #e2e8f0;
    border: 1px solid #334155;
    border-radius: 4px;
    padding: 6px 10px;
    font-size: 12px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.25);
    z-index: 12;
    pointer-events: none;
    white-space: nowrap;
    transition: opacity 0.15s ease;
  }
  
  /* Hide default tooltips on ApexCharts toolbar */
  .apexcharts-toolbar [title]::before,
  .apexcharts-toolbar [title]::after {
    display: none !important;
  }
  
  /* Apply custom styling to ApexCharts menu dropdown */
  .apexcharts-menu {
    background: #0f172a !important;
    border: 1px solid #334155 !important;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.25) !important;
    border-radius: 4px !important;
    overflow: hidden !important;
    padding: 4px 0 !important;
    min-width: 120px !important;
    z-index: 25 !important;
  }
  
  .apexcharts-menu-item {
    color: #e2e8f0 !important;
    background: transparent !important;
    transition: background 0.15s ease !important;
    padding: 6px 12px !important;
    font-size: 13px !important;
    font-family: 'Inter', sans-serif !important;
  }
  
  .apexcharts-menu-item:hover {
    background: #1e293b !important;
    color: #f8fafc !important;
  }
  
  /* Additional fixes for menu elements */
  .apexcharts-menu-icon, 
  .apexcharts-reset-icon,
  .apexcharts-zoom-icon,
  .apexcharts-zoomin-icon,
  .apexcharts-zoomout-icon,
  .apexcharts-pan-icon {
    color: #94a3b8 !important;
  }
  
  /* Specifically target the hamburger menu button */
  .apexcharts-toolbar .apexcharts-menu-icon {
    color: #94a3b8 !important;
    border-radius: 3px !important;
    width: 24px !important;
    height: 24px !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    transition: background-color 0.15s ease, color 0.15s ease !important;
  }
  
  .apexcharts-toolbar .apexcharts-menu-icon:hover {
    background-color: #1e293b !important;
    color: #f8fafc !important;
  }
  
  .apexcharts-menu-icon:hover, 
  .apexcharts-reset-icon:hover,
  .apexcharts-zoom-icon:hover,
  .apexcharts-zoomin-icon:hover,
  .apexcharts-zoomout-icon:hover,
  .apexcharts-pan-icon:hover {
    color: #f8fafc !important;
  }
  
  /* Style any dividers in the menu */
  .apexcharts-menu hr {
    border-color: #334155 !important;
    margin: 4px 0 !important;
  }
  
  /* Fix any SVG elements inside the menu */
  .apexcharts-menu svg,
  .apexcharts-menu path {
    stroke: #94a3b8 !important;
  }
  
  /* Fix submenu styles if they exist */
  .apexcharts-submenu {
    background: #0f172a !important;
    border: 1px solid #334155 !important;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.25) !important;
  }
  
  /* Fix any tooltips within the menu */
  .apexcharts-tooltip {
    background: #0f172a !important;
    border: 1px solid #334155 !important;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.25) !important;
    color: #e2e8f0 !important;
  }
  
  /* Fix any theme-specific overrides */
  .apexcharts-theme-light .apexcharts-menu,
  .apexcharts-theme-light .apexcharts-menu-item {
    background: #0f172a !important;
    color: #e2e8f0 !important;
  }
  
  /* Modal needs highest z-index */
  #chart-modal { @apply z-50; }

  /* Table Styles */
  tbody tr:nth-child(odd) td {
    background-color: rgba(30, 41, 59, 0.4); /* slate-800 with 40% opacity */
  }

  tbody tr:nth-child(even) td {
    background-color: transparent;
  }

  tbody tr:hover td {
    background-color: rgba(51, 65, 85, 0.5); /* slate-700 with 50% opacity */
  }
}

@layer components {
  /* Rank Highlights */
  #ranking-table-body tr:nth-child(1) td:nth-child(2)::before { 
    content: 'ðŸ¥‡ '; 
    @apply text-amber-400 inline-block mr-1; 
  }
  
  #ranking-table-body tr:nth-child(2) td:nth-child(2)::before { 
    content: 'ðŸ¥ˆ '; 
    @apply text-slate-400 inline-block mr-1; 
  }
  
  #ranking-table-body tr:nth-child(3) td:nth-child(2)::before { 
    content: 'ðŸ¥‰ '; 
    @apply text-orange-500 inline-block mr-1; 
  }
  
  /* Spinner */
  .spinner { 
    border: 4px solid rgba(255, 255, 255, 0.3); 
    border-radius: 50%; 
    border-top-color: hsl(var(--primary)); 
    width: 2rem; 
    height: 2rem; 
    animation: spin 1s ease-in-out infinite; 
    margin: 1rem auto; 
  }
  
  @keyframes spin { 
    to { transform: rotate(360deg); } 
  }
}

@layer utilities {
  /* Focus Visible */
  *:focus-visible { 
    @apply outline-none ring-2 ring-offset-2 ring-offset-background ring-ring; 
  }
  
  /* Active Nav Link Style (Desktop) */
  header nav a.nav-link.active { 
    @apply text-primary border-primary; 
  }
  
  /* Mobile Active Nav Link Style */
  #mobile-menu .nav-link.active { 
    @apply bg-primary text-primary-foreground; 
  }
  
  /* Language Switcher Style */
  .lang-button.active { 
    @apply bg-primary/20 text-primary; 
  }
}

/* Sort icon styles */
.sort-icon {
  display: inline-block;
  margin-left: 0.25rem;
  font-size: 10px;
  transition: opacity 0.15s, color 0.15s;
  color: hsl(var(--primary));
}

th[data-column] {
  cursor: pointer;
}

th[data-column]:hover .sort-icon {
  opacity: 1 !important;
}

/* Active sort state */
.sort-icon.opacity-100 {
  opacity: 1;
  color: hsl(var(--primary));
}

.sort-icon.opacity-50 {
  opacity: 0.5;
}

/* Remove unused opacity classes */
.opacity-0 {
  opacity: 0;
}

.opacity-25 {
  opacity: 0.25;
}

.opacity-100 {
  opacity: 1;
}

/* Ranking highlight styles */
.highlight-gold {
  background: linear-gradient(to right, rgba(245, 158, 11, 0.1), transparent 80%);
}

.highlight-silver {
  background: linear-gradient(to right, rgba(148, 163, 184, 0.1), transparent 80%);
}

.highlight-bronze {
  background: linear-gradient(to right, rgba(180, 83, 9, 0.1), transparent 80%);
}

/* Spinner animation */
@keyframes spin {
  to { transform: rotate(360deg); }
}

.animate-spin {
  animation: spin 1.5s linear infinite;
}

/* Sticky header */
thead.sticky-top {
  position: sticky;
  top: 0;
  z-index: 10;
}

/* Focus visibility */
.focus-visible:focus-visible {
  outline: 2px solid hsl(var(--ring));
  outline-offset: 2px;
}

/* Active nav link */
.nav-link.active {
  color: hsl(var(--primary));
  border-color: hsl(var(--primary));
  font-weight: 600;
}

/* Modal z-index management */
.modal-backdrop {
  z-index: 40;
}

.modal {
  z-index: 50;
}

/* Table specific styling outside of Tailwind layers */
#ranking-table-container tbody tr:nth-child(odd) td,
#detailed-table-container tbody tr:nth-child(odd) td,
#score-rules-table-container tbody tr:nth-child(odd) td {
  background-color: rgba(30, 41, 59, 0.4) !important; /* slate-800 with 40% opacity */
}

#ranking-table-container tbody tr:nth-child(even) td,
#detailed-table-container tbody tr:nth-child(even) td,
#score-rules-table-container tbody tr:nth-child(even) td {
  background-color: transparent !important;
}

#ranking-table-container tbody tr:hover td,
#detailed-table-container tbody tr:hover td,
#score-rules-table-container tbody tr:hover td {
  background-color: rgba(51, 65, 85, 0.5) !important; /* slate-700 with 50% opacity */
}

/* Mobile Responsive Tables */
@media (max-width: 640px) {
  /* Optimize table cell padding for small screens */
  table th, 
  table td {
    padding-left: 8px !important;
    padding-right: 8px !important;
    padding-top: 8px !important;
    padding-bottom: 8px !important;
  }
  
  /* Smaller fonts for tables on mobile */
  table {
    font-size: 12px !important;
  }
  
  /* Header text smaller on mobile */
  table th {
    font-size: 10px !important;
  }
  
  /* Improve scroll experience on tables */
  .overflow-x-auto {
    -webkit-overflow-scrolling: touch;
    scrollbar-width: thin;
  }
  
  /* Adjust min-width on tables to prevent tiny columns */
  table {
    min-width: max-content;
  }
  
  /* Make table containers take full width but allow horizontal scroll */
  #ranking-table-container,
  #detailed-table-container,
  #score-rules-table-container {
    max-width: 100vw;
    margin-left: -8px;
    margin-right: -8px;
    padding-left: 8px;
    padding-right: 8px;
    width: calc(100% + 16px);
  }
}

/* Chart Container Optimization for Mobile */
@media (max-width: 640px) {
  /* Reduce padding for chart containers */
  .bg-card.rounded-lg.shadow-lg.p-4.md\:p-6 {
    padding: 12px !important;
  }
  
  /* Ensure min-height is appropriate for smaller screens */
  [id$="-chart-container"] {
    min-height: 260px !important;
  }
  
  /* Fix margin/padding on containers */
  .space-y-6 > div,
  .space-y-8 > div {
    margin-top: 16px !important;
    margin-bottom: 16px !important;
  }
  
  /* Fix card padding */
  .p-3.sm\:p-4 {
    padding: 12px !important;
  }
} 